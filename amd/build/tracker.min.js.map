{"version":3,"sources":["../src/tracker.js"],"names":["define","$","Timer","Ajax","Log","Tracker","sessionId","timer","prototype","addElapsedTime","elapsedTime","call","methodname","args","sessionid","elapsedtime","start","debug","on","ticks","getTicks"],"mappings":"AAeAA,OAAM,+BAAC,CAAC,QAAD,CAAW,2BAAX,CAAwC,WAAxC,CAAqD,UAArD,CAAD,CAAmE,SAASC,CAAT,CAAYC,CAAZ,CAAmBC,CAAnB,CAAyBC,CAAzB,CAA8B,CAEnG,GAAIC,CAAAA,CAAO,CAAG,SAASC,CAAT,CAAoB,CAC9B,KAAKC,KAAL,CAAa,IAAb,CACA,KAAKD,SAAL,CAAiBA,CACpB,CAHD,CAWAD,CAAO,CAACG,SAAR,CAAkBC,cAAlB,CAAmC,SAASC,CAAT,CAAsB,CACrD,MAAOP,CAAAA,CAAI,CAACQ,IAAL,CAAU,CAAC,CACdC,UAAU,CAAE,sCADE,CACsCC,IAAI,CAAE,CACtDC,SAAS,CAAE,KAAKR,SADsC,CAEtDS,WAAW,CAAEL,CAFyC,CAD5C,CAAD,CAAV,EAKH,CALG,CAMV,CAPD,CASAL,CAAO,CAACG,SAAR,CAAkBQ,KAAlB,CAA0B,UAAW,YAEjCZ,CAAG,CAACa,KAAJ,CAAU,oBAAV,EAIA,KAAKV,KAAL,CAAa,GAAIL,CAAAA,CAAJ,CAAU,GAAV,CAAb,CACA,KAAKK,KAAL,CAAWS,KAAX,GAEAf,CAAC,CAAC,KAAKM,KAAN,CAAD,CAAcW,EAAd,CAAiB,YAAjB,CAA+B,UAAM,CACjC,GAAMC,CAAAA,CAAK,CAAG,CAAI,CAACZ,KAAL,CAAWa,QAAX,EAAd,CAEAhB,CAAG,CAACa,KAAJ,CAAU,eAAV,EAEA,GAAyB,CAArB,EAAAE,CAAK,EAAT,CAA4B,CACxBf,CAAG,CAACa,KAAJ,gCACA,CAAI,CAACR,cAAL,GACH,CACJ,CATD,CAUH,CAnBD,CAqBA,MAAOJ,CAAAA,CACV,CA5CK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\ndefine(['jquery', 'local_time_tracking/timer', 'core/ajax', 'core/log'], function($, Timer, Ajax, Log) {\n\n    let Tracker = function(sessionId) {\n        this.timer = null;\n        this.sessionId = sessionId;\n    };\n\n    /**\n     * Add elapsed time to user session.\n     *\n     * @param {int} elapsedTime\n     * @returns {Promise}\n     */\n    Tracker.prototype.addElapsedTime = function(elapsedTime) {\n        return Ajax.call([{\n            methodname: 'local_time_tracking_add_elapsed_time', args: {\n                sessionid: this.sessionId,\n                elapsedtime: elapsedTime\n            }\n        }])[0];\n    };\n\n    Tracker.prototype.start = function() {\n\n        Log.debug('TIME_TRACKER: Init');\n\n        const interval = 3;\n\n        this.timer = new Timer(1000);\n        this.timer.start();\n\n        $(this.timer).on('timer.tick', () => {\n            const ticks = this.timer.getTicks();\n\n            Log.debug('TRACKER: Tick');\n\n            if (ticks % interval === 0) {\n                Log.debug('TRACKER: Add elapsed time ' + interval);\n                this.addElapsedTime(interval);\n            }\n        });\n    };\n\n    return Tracker;\n});"],"file":"tracker.min.js"}